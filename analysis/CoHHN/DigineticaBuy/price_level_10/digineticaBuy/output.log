Namespace(dataset='digineticaBuy', epoch=20, batchSize=100, embSize=128, num_heads=4, l2=1e-05, lr=0.001, layer=2, beta=0.01, filter=False)
Usando dispositivo: cuda
[DEBUG Data.__init__] n_node=24889, n_price=11, n_category=721
[DEBUG Data.__init__] Llamando a data_easy_masks para H_T con data[2], n_row=len(data[0])=169893, n_col=n_node=24889
[DEBUG Data.__init__]   data[2] lengths: data=531548, indices=531548, indptr=169894
[DEBUG data_easy_masks] Recibido: n_row=169893, n_col=24889, len(data_l[0])=531548, len(data_l[1])=531548, len(data_l[2])=169894 (indptr)
[DEBUG data_easy_masks] Creando csr_matrix con shape=(169893, 24889), len(indptr)=169894
[DEBUG Data.__init__] H_T.sum(axis=1) para BH_T: [[8]
 [7]
 [1]
 ...
 [3]
 [1]
 [2]]
[DEBUG Data.__init__] H.sum(axis=1) para DH: [[237]
 [116]
 [ 46]
 ...
 [  2]
 [  5]
 [  1]]
[WARN Data.__init__] H.sum(axis=1) contiene ceros. Índices: [22658 23224]
[DEBUG Data.__init__] Llamando a data_easy_masks para H_pv con data[4], n_row=n_price=11, n_col=n_node=24889
[DEBUG Data.__init__]   data[4] lengths: data=24889, indices=24889, indptr=12
[DEBUG data_easy_masks] Recibido: n_row=11, n_col=24889, len(data_l[0])=24889, len(data_l[1])=24889, len(data_l[2])=12 (indptr)
[DEBUG data_easy_masks] Creando csr_matrix con shape=(11, 24889), len(indptr)=12
[DEBUG Data.__init__] Llamando a data_easy_masks para H_pc con data[5], n_row=n_price=11, n_col=n_category=721
[DEBUG Data.__init__]   data[5] lengths: data=2200, indices=2200, indptr=12
[DEBUG data_easy_masks] Recibido: n_row=11, n_col=721, len(data_l[0])=2200, len(data_l[1])=2200, len(data_l[2])=12 (indptr)
[DEBUG data_easy_masks] Creando csr_matrix con shape=(11, 721), len(indptr)=12
[DEBUG Data.__init__] Llamando a data_easy_masks para H_cv con data[6], n_row=n_category=721, n_col=n_node=24889
[DEBUG Data.__init__]   data[6] lengths: data=24889, indices=24889, indptr=722
[DEBUG data_easy_masks] Recibido: n_row=721, n_col=24889, len(data_l[0])=24889, len(data_l[1])=24889, len(data_l[2])=722 (indptr)
[DEBUG data_easy_masks] Creando csr_matrix con shape=(721, 24889), len(indptr)=722
[DEBUG Data.__init__] n_node=24889, n_price=11, n_category=721
[DEBUG Data.__init__] Llamando a data_easy_masks para H_T con data[2], n_row=len(data[0])=17647, n_col=n_node=24889
[DEBUG Data.__init__]   data[2] lengths: data=40968, indices=40968, indptr=17648
[DEBUG data_easy_masks] Recibido: n_row=17647, n_col=24889, len(data_l[0])=40968, len(data_l[1])=40968, len(data_l[2])=17648 (indptr)
[DEBUG data_easy_masks] Creando csr_matrix con shape=(17647, 24889), len(indptr)=17648
[DEBUG Data.__init__] H_T.sum(axis=1) para BH_T: [[1]
 [1]
 [3]
 ...
 [2]
 [3]
 [3]]
[DEBUG Data.__init__] H.sum(axis=1) para DH: [[16]
 [20]
 [ 4]
 ...
 [ 0]
 [ 2]
 [ 0]]
[WARN Data.__init__] H.sum(axis=1) contiene ceros. Índices: [   24    38    48 ... 24883 24886 24888]
[DEBUG Data.__init__] Llamando a data_easy_masks para H_pv con data[4], n_row=n_price=11, n_col=n_node=24889
[DEBUG Data.__init__]   data[4] lengths: data=24889, indices=24889, indptr=12
[DEBUG data_easy_masks] Recibido: n_row=11, n_col=24889, len(data_l[0])=24889, len(data_l[1])=24889, len(data_l[2])=12 (indptr)
[DEBUG data_easy_masks] Creando csr_matrix con shape=(11, 24889), len(indptr)=12
[DEBUG Data.__init__] Llamando a data_easy_masks para H_pc con data[5], n_row=n_price=11, n_col=n_category=721
[DEBUG Data.__init__]   data[5] lengths: data=2200, indices=2200, indptr=12
[DEBUG data_easy_masks] Recibido: n_row=11, n_col=721, len(data_l[0])=2200, len(data_l[1])=2200, len(data_l[2])=12 (indptr)
[DEBUG data_easy_masks] Creando csr_matrix con shape=(11, 721), len(indptr)=12
[DEBUG Data.__init__] Llamando a data_easy_masks para H_cv con data[6], n_row=n_category=721, n_col=n_node=24889
[DEBUG Data.__init__]   data[6] lengths: data=24889, indices=24889, indptr=722
[DEBUG data_easy_masks] Recibido: n_row=721, n_col=24889, len(data_l[0])=24889, len(data_l[1])=24889, len(data_l[2])=722 (indptr)
[DEBUG data_easy_masks] Creando csr_matrix con shape=(721, 24889), len(indptr)=722
-------------------------------------------------------
epoch:  0
start training:  2025-06-01 01:12:03.372573
        Loss:   10684.898
start predicting:  2025-06-01 01:20:21.248846
{'hit1': 8.514124293785311, 'mrr1': 8.514124293785311, 'ndcg1': 8.514124293785311, 'hit5': 24.937853107344633, 'mrr5': 14.157250470809792, 'ndcg5': 16.8177330451619, 'hit10': 36.59322033898305, 'mrr10': 15.689776701641106, 'ndcg10': 20.563763225254338, 'hit20': 50.8587570621469, 'mrr20': 16.676995013934853, 'ndcg20': 24.166959150209976}
P@1     P@5     M@5     N@5     P@10    M@10    N@10    P@20    M@20    N@20
8.51     24.94   14.16   16.82   36.59   15.69   20.56   50.86   16.68   24.17
0        0       0       0       0       0       0       0       0       0
-------------------------------------------------------
epoch:  1
start training:  2025-06-01 01:21:17.405261
        Loss:   8241.188
start predicting:  2025-06-01 01:29:30.738612
{'hit1': 14.259887005649718, 'mrr1': 14.259887005649718, 'ndcg1': 14.259887005649718, 'hit5': 36.03954802259887, 'mrr5': 22.014595103578156, 'ndcg5': 25.490833767040726, 'hit10': 48.706214689265536, 'mrr10': 23.69430544345798, 'ndcg10': 29.576204279369335, 'hit20': 62.22033898305085, 'mrr20': 24.634081526110048, 'ndcg20': 32.99540570480236}
P@1     P@5     M@5     N@5     P@10    M@10    N@10    P@20    M@20    N@20
14.26    36.04   22.01   25.49   48.71   23.69   29.58   62.22   24.63   33.00
1        1       1       1       1       1       1       1       1       1
-------------------------------------------------------
epoch:  2
start training:  2025-06-01 01:30:28.193763
        Loss:   7419.646
start predicting:  2025-06-01 01:38:45.869597
{'hit1': 14.689265536723164, 'mrr1': 14.689265536723164, 'ndcg1': 14.689265536723164, 'hit5': 37.259887005649716, 'mrr5': 22.74180790960452, 'ndcg5': 26.34066599726142, 'hit10': 49.84180790960452, 'mrr10': 24.409768182225807, 'ndcg10': 30.398293118156055, 'hit20': 63.31638418079096, 'mrr20': 25.342950122584252, 'ndcg20': 33.802618590667706}
P@1     P@5     M@5     N@5     P@10    M@10    N@10    P@20    M@20    N@20
14.69    37.26   22.74   26.34   49.84   24.41   30.40   63.32   25.34   33.80
2        2       2       2       2       2       2       2       2       2
-------------------------------------------------------
epoch:  3
start training:  2025-06-01 01:39:42.830415
        Loss:   6872.780
start predicting:  2025-06-01 01:47:51.321063
{'hit1': 15.231638418079097, 'mrr1': 15.231638418079097, 'ndcg1': 15.231638418079097, 'hit5': 37.485875706214685, 'mrr5': 23.210357815442563, 'ndcg5': 26.752644810223654, 'hit10': 49.66101694915254, 'mrr10': 24.827165725047077, 'ndcg10': 30.681632098232114, 'hit20': 63.05084745762712, 'mrr20': 25.757201979321803, 'ndcg20': 34.06814939020202}
P@1     P@5     M@5     N@5     P@10    M@10    N@10    P@20    M@20    N@20
15.23    37.49   23.21   26.75   49.84   24.83   30.68   63.32   25.76   34.07
3        3       3       3       2       3       3       2       3       3
-------------------------------------------------------
epoch:  4
start training:  2025-06-01 01:48:50.010175
        Loss:   6380.856
start predicting:  2025-06-01 01:57:01.044880
{'hit1': 14.92090395480226, 'mrr1': 14.92090395480226, 'ndcg1': 14.92090395480226, 'hit5': 36.80225988700565, 'mrr5': 22.72090395480226, 'ndcg5': 26.211687948795763, 'hit10': 48.5819209039548, 'mrr10': 24.288971841090483, 'ndcg10': 30.016897347752476, 'hit20': 62.07909604519774, 'mrr20': 25.22699915597998, 'ndcg20': 33.431227107591056}
P@1     P@5     M@5     N@5     P@10    M@10    N@10    P@20    M@20    N@20
15.23    37.49   23.21   26.75   49.84   24.83   30.68   63.32   25.76   34.07
3        3       3       3       2       3       3       2       3       3
-------------------------------------------------------
epoch:  5
start training:  2025-06-01 01:57:59.570922
        Loss:   5847.093
start predicting:  2025-06-01 02:06:05.583443
{'hit1': 14.112994350282484, 'mrr1': 14.112994350282484, 'ndcg1': 14.112994350282484, 'hit5': 35.75706214689266, 'mrr5': 21.946516007532956, 'ndcg5': 25.37727942251451, 'hit10': 48.02824858757062, 'mrr10': 23.578199264639945, 'ndcg10': 29.339327926058385, 'hit20': 60.610169491525426, 'mrr20': 24.45559831873129, 'ndcg20': 32.52564690856549}
P@1     P@5     M@5     N@5     P@10    M@10    N@10    P@20    M@20    N@20
15.23    37.49   23.21   26.75   49.84   24.83   30.68   63.32   25.76   34.07
3        3       3       3       2       3       3       2       3       3
-------------------------------------------------------
epoch:  6
start training:  2025-06-01 02:07:03.406592
        Loss:   5251.678
start predicting:  2025-06-01 02:15:08.762247
{'hit1': 13.666666666666666, 'mrr1': 13.666666666666666, 'ndcg1': 13.666666666666666, 'hit5': 34.570621468926554, 'mrr5': 21.114218455743877, 'ndcg5': 24.449103342884445, 'hit10': 46.152542372881356, 'mrr10': 22.650950587391264, 'ndcg10': 28.185419226206964, 'hit20': 58.73446327683616, 'mrr20': 23.52826659827106, 'ndcg20': 31.37189971397777}
P@1     P@5     M@5     N@5     P@10    M@10    N@10    P@20    M@20    N@20
15.23    37.49   23.21   26.75   49.84   24.83   30.68   63.32   25.76   34.07
3        3       3       3       2       3       3       2       3       3
-------------------------------------------------------
epoch:  7
start training:  2025-06-01 02:16:06.591555
        Loss:   4643.650
start predicting:  2025-06-01 02:24:16.010987
{'hit1': 13.067796610169491, 'mrr1': 13.067796610169491, 'ndcg1': 13.067796610169491, 'hit5': 33.48587570621469, 'mrr5': 20.405461393596987, 'ndcg5': 23.651855983578347, 'hit10': 44.53107344632768, 'mrr10': 21.86490673482199, 'ndcg10': 27.208936354720358, 'hit20': 56.8135593220339, 'mrr20': 22.716049454399535, 'ndcg20': 30.312836824118904}
P@1     P@5     M@5     N@5     P@10    M@10    N@10    P@20    M@20    N@20
15.23    37.49   23.21   26.75   49.84   24.83   30.68   63.32   25.76   34.07
3        3       3       3       2       3       3       2       3       3
-------------------------------------------------------
epoch:  8
start training:  2025-06-01 02:25:13.926084
        Loss:   4072.855
start predicting:  2025-06-01 02:33:19.208216
{'hit1': 11.887005649717514, 'mrr1': 11.887005649717514, 'ndcg1': 11.887005649717514, 'hit5': 32.22033898305085, 'mrr5': 19.140112994350282, 'ndcg5': 22.383179121818632, 'hit10': 42.92655367231639, 'mrr10': 20.565536723163845, 'ndcg10': 25.84180739287944, 'hit20': 54.93220338983051, 'mrr20': 21.39559724445462, 'ndcg20': 28.873375512716205}
P@1     P@5     M@5     N@5     P@10    M@10    N@10    P@20    M@20    N@20
15.23    37.49   23.21   26.75   49.84   24.83   30.68   63.32   25.76   34.07
3        3       3       3       2       3       3       2       3       3
-------------------------------------------------------
epoch:  9
start training:  2025-06-01 02:34:16.516306
        Loss:   3594.748
start predicting:  2025-06-01 02:42:24.081628
{'hit1': 11.491525423728815, 'mrr1': 11.491525423728815, 'ndcg1': 11.491525423728815, 'hit5': 31.107344632768363, 'mrr5': 18.47542372881356, 'ndcg5': 21.606275477283404, 'hit10': 41.655367231638415, 'mrr10': 19.87893686664873, 'ndcg10': 25.01317934376009, 'hit20': 53.42372881355932, 'mrr20': 20.695605737625076, 'ndcg20': 27.988827989656258}
P@1     P@5     M@5     N@5     P@10    M@10    N@10    P@20    M@20    N@20
15.23    37.49   23.21   26.75   49.84   24.83   30.68   63.32   25.76   34.07
3        3       3       3       2       3       3       2       3       3
-------------------------------------------------------
epoch:  10
start training:  2025-06-01 02:43:22.620919
        Loss:   3205.247
start predicting:  2025-06-01 02:51:30.663180
{'hit1': 11.129943502824858, 'mrr1': 11.129943502824858, 'ndcg1': 11.129943502824858, 'hit5': 29.977401129943505, 'mrr5': 17.89858757062147, 'ndcg5': 20.896731416201575, 'hit10': 40.59322033898305, 'mrr10': 19.32025378889786, 'ndcg10': 24.334505306917602, 'hit20': 52.271186440677965, 'mrr20': 20.131734259353376, 'ndcg20': 27.288482841332986}
P@1     P@5     M@5     N@5     P@10    M@10    N@10    P@20    M@20    N@20
15.23    37.49   23.21   26.75   49.84   24.83   30.68   63.32   25.76   34.07
3        3       3       3       2       3       3       2       3       3
-------------------------------------------------------
epoch:  11
start training:  2025-06-01 02:52:29.993302
        Loss:   2910.783
start predicting:  2025-06-01 03:00:35.599023
{'hit1': 10.677966101694915, 'mrr1': 10.677966101694915, 'ndcg1': 10.677966101694915, 'hit5': 29.774011299435028, 'mrr5': 17.50574387947269, 'ndcg5': 20.548337361694045, 'hit10': 40.3954802259887, 'mrr10': 18.92215496368039, 'ndcg10': 23.981880359330532, 'hit20': 51.32768361581921, 'mrr20': 19.68260955175672, 'ndcg20': 26.748220828309215}
P@1     P@5     M@5     N@5     P@10    M@10    N@10    P@20    M@20    N@20
15.23    37.49   23.21   26.75   49.84   24.83   30.68   63.32   25.76   34.07
3        3       3       3       2       3       3       2       3       3
-------------------------------------------------------
epoch:  12
start training:  2025-06-01 03:01:33.617493
        Loss:   2675.419
start predicting:  2025-06-01 03:09:40.097681
{'hit1': 10.305084745762711, 'mrr1': 10.305084745762711, 'ndcg1': 10.305084745762711, 'hit5': 29.40677966101695, 'mrr5': 17.1515065913371, 'ndcg5': 20.19147107452643, 'hit10': 39.175141242937855, 'mrr10': 18.453833736884583, 'ndcg10': 23.3490701477973, 'hit20': 49.97175141242938, 'mrr20': 19.200642314075044, 'ndcg20': 26.075901503595304}
P@1     P@5     M@5     N@5     P@10    M@10    N@10    P@20    M@20    N@20
15.23    37.49   23.21   26.75   49.84   24.83   30.68   63.32   25.76   34.07
3        3       3       3       2       3       3       2       3       3
-------------------------------------------------------
epoch:  13
start training:  2025-06-01 03:10:38.498313
        Loss:   2490.777
start predicting:  2025-06-01 03:18:45.361989
{'hit1': 9.90960451977401, 'mrr1': 9.90960451977401, 'ndcg1': 9.90960451977401, 'hit5': 29.16949152542373, 'mrr5': 16.74708097928437, 'ndcg5': 19.82588215039745, 'hit10': 38.89830508474576, 'mrr10': 18.045034077661196, 'ndcg10': 22.97127486630457, 'hit20': 49.36158192090396, 'mrr20': 18.76705359379639, 'ndcg20': 25.611861936899228}
P@1     P@5     M@5     N@5     P@10    M@10    N@10    P@20    M@20    N@20
15.23    37.49   23.21   26.75   49.84   24.83   30.68   63.32   25.76   34.07
3        3       3       3       2       3       3       2       3       3
-------------------------------------------------------
epoch:  14
start training:  2025-06-01 03:19:43.000058
        Loss:   2346.987
start predicting:  2025-06-01 03:27:49.699033
{'hit1': 10.050847457627118, 'mrr1': 10.050847457627118, 'ndcg1': 10.050847457627118, 'hit5': 29.02824858757062, 'mrr5': 16.821280602636534, 'ndcg5': 19.849040495564218, 'hit10': 38.887005649717516, 'mrr10': 18.14435252443727, 'ndcg10': 23.044454874473267, 'hit20': 49.72316384180791, 'mrr20': 18.89589809623655, 'ndcg20': 25.783598467257328}
P@1     P@5     M@5     N@5     P@10    M@10    N@10    P@20    M@20    N@20
15.23    37.49   23.21   26.75   49.84   24.83   30.68   63.32   25.76   34.07
3        3       3       3       2       3       3       2       3       3
-------------------------------------------------------
epoch:  15
start training:  2025-06-01 03:28:46.939359
        Loss:   2229.052
start predicting:  2025-06-01 03:36:54.480505
{'hit1': 9.51412429378531, 'mrr1': 9.51412429378531, 'ndcg1': 9.51412429378531, 'hit5': 28.52542372881356, 'mrr5': 16.315065913370997, 'ndcg5': 19.343089303741525, 'hit10': 38.175141242937855, 'mrr10': 17.60033853466057, 'ndcg10': 22.460885846126544, 'hit20': 48.7457627118644, 'mrr20': 18.328514532326125, 'ndcg20': 25.12689266335742}
P@1     P@5     M@5     N@5     P@10    M@10    N@10    P@20    M@20    N@20
15.23    37.49   23.21   26.75   49.84   24.83   30.68   63.32   25.76   34.07
3        3       3       3       2       3       3       2       3       3
-------------------------------------------------------
epoch:  16
start training:  2025-06-01 03:37:53.095589
        Loss:   2140.453
start predicting:  2025-06-01 03:45:59.459571
{'hit1': 9.728813559322035, 'mrr1': 9.728813559322035, 'ndcg1': 9.728813559322035, 'hit5': 28.09604519774011, 'mrr5': 16.300470809792845, 'ndcg5': 19.227125263894813, 'hit10': 37.76836158192091, 'mrr10': 17.589953815801273, 'ndcg10': 22.353603820210356, 'hit20': 47.824858757062145, 'mrr20': 18.291133000058856, 'ndcg20': 24.900179052747045}
P@1     P@5     M@5     N@5     P@10    M@10    N@10    P@20    M@20    N@20
15.23    37.49   23.21   26.75   49.84   24.83   30.68   63.32   25.76   34.07
3        3       3       3       2       3       3       2       3       3
-------------------------------------------------------
epoch:  17
start training:  2025-06-01 03:46:57.307462
        Loss:   2051.230
start predicting:  2025-06-01 03:55:07.593745
{'hit1': 9.457627118644067, 'mrr1': 9.457627118644067, 'ndcg1': 9.457627118644067, 'hit5': 28.02824858757062, 'mrr5': 16.02824858757062, 'ndcg5': 18.999723137730047, 'hit10': 37.66101694915254, 'mrr10': 17.319448928347235, 'ndcg10': 22.120658399400874, 'hit20': 48.11864406779661, 'mrr20': 18.04436478927873, 'ndcg20': 24.763731364761284}
P@1     P@5     M@5     N@5     P@10    M@10    N@10    P@20    M@20    N@20
15.23    37.49   23.21   26.75   49.84   24.83   30.68   63.32   25.76   34.07
3        3       3       3       2       3       3       2       3       3
-------------------------------------------------------
epoch:  18
start training:  2025-06-01 03:56:05.806394
        Loss:   1975.591
start predicting:  2025-06-01 04:04:14.871125
{'hit1': 9.463276836158192, 'mrr1': 9.463276836158192, 'ndcg1': 9.463276836158192, 'hit5': 28.09039548022599, 'mrr5': 16.068173258003764, 'ndcg5': 19.046345771601406, 'hit10': 38.039548022598865, 'mrr10': 17.40002017756255, 'ndcg10': 22.26761050825947, 'hit20': 48.35028248587571, 'mrr20': 18.10956724605187, 'ndcg20': 24.866975913991734}
P@1     P@5     M@5     N@5     P@10    M@10    N@10    P@20    M@20    N@20
15.23    37.49   23.21   26.75   49.84   24.83   30.68   63.32   25.76   34.07
3        3       3       3       2       3       3       2       3       3
-------------------------------------------------------
epoch:  19
start training:  2025-06-01 04:05:12.207382
        Loss:   1923.492
start predicting:  2025-06-01 04:13:18.666430
{'hit1': 9.587570621468927, 'mrr1': 9.587570621468927, 'ndcg1': 9.587570621468927, 'hit5': 28.37853107344633, 'mrr5': 16.27146892655367, 'ndcg5': 19.273656438787107, 'hit10': 37.836158192090394, 'mrr10': 17.53003318088064, 'ndcg10': 22.328454370204582, 'hit20': 48.2316384180791, 'mrr20': 18.253849682726866, 'ndcg20': 24.959764361703122}
P@1     P@5     M@5     N@5     P@10    M@10    N@10    P@20    M@20    N@20
15.23    37.49   23.21   26.75   49.84   24.83   30.68   63.32   25.76   34.07
3        3       3       3       2       3       3       2       3       3